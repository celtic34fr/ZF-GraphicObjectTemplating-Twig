{# template de l'objet ODNotification #}

{% if objet.action == 'init' %}
    <div id="{{ objet.id }}_div">
        {# initialisation Ã  mettre au niveau du header de la page #}
        <script>
            var {{ objet.id }}Lobibox = Lobibox;
            $(document).ready(
                    {{ objet.id }}Lobibox.base.DEFAULTS = $.extend({}, {{ objet.id }}Lobibox.base.DEFAULTS, {
                        horizontalOffset: {{ objet.horizontalOffset }},
                        verticalOffset: {{ objet.verticalOffset }},
                        width: {{ objet.width }},
                        height: {{ objet.height }},
                        closeButton: {{ objet.closeButton }},
                        draggable: false,
                        customBtnClass: 'lobibox-btn lobibox-btn-default',
                        modal: true,
                        debug: false,
                        buttonsAlign: {{ objet.buttonAlifgn }},
                        closeOnEsc: {{ closeOnEsc }},
                        delayToRemove: {{ objet.delaytoRemove }},
                        delay: {{ objet.delay }},
                        baseClass: 'animated-super-fast',
                        showClass: 'zoomIn',
                        hideClass: 'zoomOut',
                        iconSource: 'bootstrap',
            {% switch(objet.msgType) %}
                {% case 'confirm' %}
                {% case 'alert' %}
                    {% if objet.title is defined and objet.title is not empty %}
                        title: {{ objet.title }},
                    {% endif %}
                {% case 'prompt' %}
                    {% if objet.value is defined and objet.value is not empty %}
                        value: '{{ objet.value }}',
                    {% endif %}
                       multiline: {{ objet.multiline }},
                    {% if objet.multiline %}
                        lines: {{ objet.lines }},
                    {% endif %}
                        type: '{{ objet.type }}',
                    {% if objet.label is defined and objet.label is not empty %}
                        label: '{{ objet.label }}',
                    {% endif %}
                        required: {{ objet.required }},
                    {% if objet.errorMessage is defined and objet.errorMessage is not empty %}
                        errorMessage: '{{ objet.errorMessage }}',
                    {% endif %}
                {% case 'progress' %}
                {% case 'window' %}
            {% endswitch %}
                     })
            );
        </script>
        <input id="{{ objet.id }}ListLength" type="hidden" name="listLength" value="0"/>
        <script id="{{ objet.id }}" type="text/javascript">
        </script>
    </div>
{% endif %}

{% if objet.action == 'send' %}
    <script id='{{ objet.id }}' type="text/javascript">
        if ( {{ objet.id }}Lobibox.notify.list.length == 0) {
            {{ objet.id }}Lobibox.notify('{{ objet.type }}', {
                showAfterPrevious: {{ objet.showAfterPrevious ? 'true' : 'false' }},
                {% if objet.title is not empty %} title: '{{ objet.title }}', {% endif %}
                {% if objet.sound == false %} sound: false, {% endif %}
                delay: {{ objet.delay }},
                msg: '{{ objet.body }}'
            });
            $('#{{ objet.id }}ListLength').val(1);
        } else {
            var listLength = parseInt($('#{{ objet.id }}ListLength').val());
            var delayTime  = {{ objet.delayMessage }} * listLength;
            setTimeout(function () {
                {{ objet.id }}Lobibox.notify('{{ objet.type }}', {
                    showAfterPrevious: {{ objet.showAfterPrevious ? 'true' : 'false' }},
                    {% if objet.title is not empty %} title: '{{ objet.title }}', {% endif %}
                    {% if objet.sound == false %} sound: false, {% endif %}
                    delay: {{ objet.delay }},
                    msg: '{{ objet.body }}'
                });
            }, delayTime );
            $('#{{ objet.id }}ListLength').val(listLength + 1);
        }
    </script>
{% endif %}
