{# mod_le pour l'affichage de l'objet ODDropzone #}

{% set filesize = '{{ filesize }}' %}
{% if objet.message is empty %}
    {% set message = "DÃ©poser vos fichiers ..." %}
{% else %}
    {% set message = objet.message %}
{% endif %}

<div id="{{ objet.id }}" class="gotObject hidden {{ objet.classes }} form-group"
        {% if objet.form is not empty %} data-form="{{ objet.form }}" {% endif %}
     data-objet="{{ objet.object }}" data-display="{{ objet.display }}" data-widthbt="{{ objet.widthBT }}"
        {% include "zf3-graphic-object-templating/oobjects/eventsHTML.twig" with {'events':objet.event} %}
>
    <form action="{{ url('gotDropzone') }}" class="dropzone" id="{{ objet.id }}Form"></form>

    <style>
        #{{ objet.id }} {
            height: 10em;
            max-width: 720px;
            margin-left: auto;
            margin-right: auto;
            border:  1px solid black;
        }
    </style>

    <script>
        $(document).ready(function() {
            {#Dropzone.autoDiscover = false;#}
            {#var {{ objet.id }}Dropzone = new Dropzone("#{{ objet.id }}Form", {#}
            $('#{{ objet.id }}Form').options({
                init: function() {
                    thisDropzone = this;
                    $.get('{{ url('gotDropzone') }}', function(data) {
                        $.each(data, function(key,value){
                            var mockFile = { name: value.name, size: value.size };
                            thisDropzone.options.addedfile.call(thisDropzone, mockFile);
                            thisDropzone.options.thumbnail.call(thisDropzone, mockFile, "{{ url('gotDropzone') }}/"+value.name);
                        });
                    });
                }
            });
        });
    </script>
</div>